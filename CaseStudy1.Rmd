---
title: "Maternal Smoking and Infant Death Statistical Analysis"
date: "October 13, 2024"
output: pdf_document
fontsize: 12pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
babies <- read.table("babies.txt", header = TRUE, sep="")
```

# 1. Introduction

This report investigates the potential differences in birth weight between babies born to mothers who smoked during pregnancy and those who did not. Epidemiological research has consistently linked smoking during pregnancy to low birth weights and preterm birth. Birth weight is an indicator of a newborn's health, with lower birth weights associated with an increased risk of infant mortality. This study seeks to quantify the effects of maternal smoking on infant health through statistical analysis using data from the Child Health and Development Studies (CHDS) dataset. 

The CHDS dataset includes data on 1236 babies, all male, who were born between 1960 and 1967 to mothers enrolled in the Kaiser Health Plan in Oakland, California. Each baby was a single birth and survived for at least 28 days after birth. Variables in the dataset include birth weight, length of gestation, whether or not this was the mother's first pregnancy, mother's age, mother's height, mother's weight, and whether or not the mother was a smoker. 

The primary objective is to answer the question: Is there a statistically significant difference in birth weights between babies born to mothers who smoked during pregnancy and those who did not? Specifically, we will explore the distribution of birth weights for both smokers and non-smokers, the incidence of low birth weight (under 100 ounces) in both groups, the potential variability in these comparisons based on different statistical methods. Using numerical, graphical, and incidence comparison approaches to answering this question, we found that [our results].

The report is structured as follows: Section 1 addresses each of the research questions outlined above, focusing on the numerical, graphical, and incidence comparisons between the smoking and non-smoking groups; Section 2 covers the statistical analysis processes and results; Section 3 expands the analysis by examining other variables that may impact birth weight; and Section 4 discusses the conclusions and implications of the results. Overall, this report will determine whether the difference in weight between babies born to mothers who smoked during pregnancy and those who did not is significant for the health of the baby.


# 2. Analysis

## 2.1. Data Processing

### 2.1.1. Methods

>>The first step of our analysis was to examine the dataset and understand the characteristics and distributions of each variable. We reviewed all variables and determined their type (numerical or categorical) and identified any outliers or irregularities. To do this, we looked at the distributions of each variable graphically using a histogram.


### 2.1.2. Analysis

```{r, echo=FALSE, fig.width=3, fig.height=2.5}
hist(babies$bwt, 
     main = "Birth Weight", 
     xlab = "birth weight (oz)")
hist(babies$gestation, 
     main = "Gestation", 
     xlab = "length of gestation (days)")
hist(babies$parity, 
     breaks = 2, 
     main = "First Pregnancy Indicator", 
     xlab = "parity")
hist(babies$age, 
     main = "Mother's Age", 
     xlab = "age (yrs)")
hist(babies$height, 
     main = "Mother's Height", 
     xlab = "height (in)")
hist(babies$weight, 
     main = "Mother's Weight", 
     xlab = "weight (lbs)")
hist(babies$smoke,
     breaks= 2,
     main = "Whether the Mother Smokes", 
     xlab = "parity")
```

>>While looking at the histograms, we noticed that some of the data in the dataset were outside of a reasonable range for those variables. Some women had listed gestation periods of up to 1000 days while others were described as over 8 feet or up to 1000 pounds. So, while cleaning the dataset, we removed these outliers to complete the analysis without them.

>>After cleaning the data, we plotted the same histograms again with the cleaned dataset.

```{r, echo=FALSE, fig.width=3, fig.height=2.5}
cleaned_df <- subset(subset(babies, parity <= 1), smoke <= 1)
cleaned_df <- subset(cleaned_df, weight <= 500)
cleaned_df <- subset(cleaned_df, gestation <= 375)
cleaned_df <- subset(cleaned_df, height <= 85)
cleaned_df <- subset(cleaned_df, age <= 60)

hist(cleaned_df$bwt, 
     main = "Birth Weight v2.", 
     xlab = "birth weight (oz)")
hist(cleaned_df$gestation, 
     main = "Gestation v2.", 
     xlab = "length of gestation (days)")
hist(cleaned_df$parity, 
     breaks = 2, 
     main = "First Pregnancy Indicator v2.", 
     xlab = "parity")
hist(cleaned_df$age, 
     main = "Mother's Age v2.", 
     xlab = "mother's age (yrs)")
hist(cleaned_df$height, 
     main = "Mother's Height v2.", 
     xlab = "mother's height (in)")
hist(cleaned_df$weight, 
     main = "Mother's Weight v2.", 
     xlab = "mother's weight (lbs)")
hist(cleaned_df$smoke, 
     breaks = 2, 
     main = "Whether the Mother Smokes v2.", 
     xlab = "parity")
```



### 2.1.3. Conclusion

>>We concluded that the dataset does not qualify as a simple random sample because of the method in which it was collected. In order to qualify as a simple random sample, every pregnant women would need to have had an equal chance of being selected. However, in this dataset the pregnant women selected were limited to a certain time frame (1960-1967) and were limited to a specific health plan in a single region. Therefore, this dataset does not qualify as a simple random sample. This means that the dataset is not representative of the entire population and the results of the analysis cannot be generalized.


## 2.2. Numerical Analysis of Birth Weight Distributions

### 2.2.1. Methods

>>Now that we had examined the dataset and each variable as a whole, we looked at the two distributions of birth weights for babies born to women who smoked during their pregnancy and for babies born to women who did not smoke during their pregnancy. Summarizing these distributions numerically, we calculated the minimum, maximum, mean, median, standard deviation, and quartile values.  


### 2.2.2. Analysis

>>We found that the numerical summaries were as follows:

```{r, echo=FALSE}
library(knitr)
library(kableExtra)

numerical_summaries <- data.frame(
  Smokers = c(58, 163, 113.8192, 115, 18.0989, 101, 126),
  Non_Smokers = c(55, 176, 123.0853, 123, 17.3987, 113, 134)
)
rownames(numerical_summaries) <- c("Minimum", "Maximum", "Mean", "Median", "Standard Deviation", "Q1", "Q3")

kable(numerical_summaries, caption = "Numerical Differences in Distributions of Smoking and Non-Smoking Mothers") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = FALSE)
```

>>Most of these numerical summaries show that the birth weights of babies of mothers who are non-smokers are larger than the birth weights of babies of mothers who are smokers. To determine whether or not those differences are significant would require further analysis.


### 2.2.3. Conclusion

>>We found that the mean and median birth weights of the smokers were 114.1095 and 115 respectively while the mean and median birth weights of the non-smokers were 123.0472 and 123 respectively. Since the means and medians of the two distributions were very similar, we can infer that the shapes of the two distributions are almost symmetrical.


## 2.3. Graphical Analysis of Birth Weight Distributions

### 2.3.1. Methods

>>Now that we've summarized the two distributions numerically, we also want to look at them graphically. 

### 2.3.2. Analysis

>>We plotted two graphs, one with the birth weight distribution of women who are non-smokers and another with the birth weight distribution of women who are smokers. We then layered the two histograms for direct comparison.

```{r, echo=FALSE, include=FALSE}
smoker_df <- cleaned_df[cleaned_df$smoke == 1,]
nonsmoker_df <- cleaned_df[cleaned_df$smoke == 0,]
p1 <- hist(smoker_df$bwt, freq = FALSE)
p2 <- hist(nonsmoker_df$bwt, freq = FALSE)
```

```{r, echo=FALSE, fig.width=7, fig.height=4}
plot( p1, 
      col=rgb(0,0,1,1/4),
      main = "Birth Weights",
      xlim = c(50,190),
      freq = FALSE,
      ylim = c(0,0.026),
      xlab = "birth weight (oz)")

plot( p2, 
      col=rgb(1,0,0,1/4),  
      xlim = c(50,190),
      freq = FALSE,
      add = TRUE)

legend(150, 0.025, 
       c("smokers", "nonsmokers"), 
       lwd=4, 
       col=c(rgb(0,0,1,1/4), rgb(1,0,0,1/4)))
```


### 2.3.3. Conclusion

>>Based on the layering of the two distributions, the distribution of the baby weights of the mothers who are smokers is shifted to the left of the the distribution of the baby weights of the mothers who are non-smokers. This shows that overall, the baby weights of mothers who are smokers is less than the baby weights of mothers who are non-smokers. To determine whether or not this amount is significant, further analysis would need to be done.

## 2.4. Incidence Analysis of Low Birth Weights

### 2.4.1. Methods

>>Now that we've done both numerical and graphical analysis, we want to use one final comparison approach: incidence comparison. Using 100 ounces as the threshold of a low-weight baby, we found the percentages of babies that weigh under that threshold for both smoking and non-smoking mothers. We then adjusted the threshold to observe any changes in the incidences of low-weight births.

### 2.4.2. Analysis

>>We found that the percentages of low-weight babies are as follows:

>>Percentage of low-weight babies in smoking mothers: 64.70588%

>>Percentage of low-weight babies in non-smoking mothers: 35.29412%

>>Then, we wanted to visualize the changes in the incidences of low birth weights as the threshold changes. So, we used every integer between the minimum and maximum birth weights as a threshold and recorded how the percentages of low-weight babies in smoking vs. non-smoking mothers changed. The results of this are shown below.

```{r, echo=FALSE, fig.width=7, fig.height=4}
low_weight_babies_df <- cleaned_df[cleaned_df$bwt < 100,]

# Proportions for low birth weight babies
low_bwt_nonsmoker <- dim(low_weight_babies_df[
  low_weight_babies_df$smoke == 0,])[1] / dim(low_weight_babies_df)[1] # 35.2941 %
low_bwt_smoker <- dim(low_weight_babies_df[
  low_weight_babies_df$smoke == 1,])[1] / dim(low_weight_babies_df)[1] # 64.7059 %
results_df <- data.frame(threshold = integer(), 
                         low_bwt_nonsmoker = numeric(), 
                         low_bwt_smoker = numeric())

# Changes in proportions of birth weight
for (threshold in 55:176) {
  low_weight_df <- cleaned_df[cleaned_df$bwt < threshold, ]
  
    if (dim(low_weight_babies_df)[1] > 0) {
    nonsmoker <- dim(low_weight_df[
      low_weight_df$smoke == 0, ])[1] / dim(low_weight_df)[1]
    smoker <- dim(low_weight_df[
      low_weight_df$smoke == 1, ])[1] / dim(low_weight_df)[1]
  }
  
  results_df <- rbind(results_df, data.frame(threshold = threshold,
                                             low_bwt_nonsmoker = nonsmoker,
                                             low_bwt_smoker = smoker))
  results_df[, 2:3] <- lapply(results_df[, 2:3], function(x) round(x, 4))
}

plot(results_df$threshold, results_df$low_bwt_nonsmoker, type = "l", 
     col = "red", lwd = 2, 
     xlab = "Threshold (ounces)", 
     ylab = "Proportion of Low Birth Weight Babies", 
     main = "Low Birth Weight Babies by Smoking Status",
     xlim = c(55,176),
     ylim = c(0,1))

lines(results_df$threshold, results_df$low_bwt_smoker, col = "blue", lwd = 2)

legend("topright", legend = c("Smoker", "Non-smoker"), 
       col = c("blue", "red"), lwd = 2)

```

### 2.4.3. Conclusion

>>As shown in the graph above, the incidences of low-weight babies in smoking mothers is greater than the incidences of low-weight babies in non-smoking mothers when the threshold for low-weight babies is between 70 and 120. Outside of that range, the results are flipped.

## 2.5 Comparative Analysis of Various Analysis Types

### Numerical Analysis

### Graphical Analysis

### Incidence Analysis

# 3. Discussion
